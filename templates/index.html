<!DOCTYPE html>
<html >
<!--From https://codepen.io/frytyler/pen/EGdtg-->
<head>
  <meta charset="UTF-8">
  <title>ML API</title>
  <link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Arimo' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Hind:300' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://rawgit.com/adrotec/knockout-file-bindings/master/knockout-file-bindings.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.1.0/knockout-min.js"></script>
<script src="https://rawgit.com/adrotec/knockout-file-bindings/master/knockout-file-bindings.js"></script>
<script>
  function results(){

  }

  $(function(){
  var viewModel = {};

  viewModel.fileData = ko.observable({
    dataURL: ko.observable(),
    // base64String: ko.observable(),
  });
  viewModel.multiFileData = ko.observable({
    dataURLArray: ko.observableArray(),
  });
  viewModel.onClear = function(fileData){
    if(confirm('Are you sure?')){
      fileData.clear && fileData.clear();
    }                            
  };
  viewModel.debug = function(){
    window.viewModel = viewModel;
    console.log(ko.toJSON(viewModel));
    // debugger; 
  };
  ko.applyBindings(viewModel);
});

$(document).ready(function(){
    $("#but_upload").click(function(){
        var fd = new FormData();
        var files = $('#file')[0].files[0];
        fd.append('file',files);

        $.ajax({
            url: '/image',
            type: 'post',
            data: fd,
            contentType: false,
            processData: false,
            success: function(response){
                if(response != 0){
                    let img = document.getElementById('myImgTag').setAttribute('src','data:image/png;base64, YOUR_BASE64_STRING_FROM_RESPONSE')
                    $("#img").attr("src",response);
                    $(".preview img").show(); // Display image element
                }else{
                    alert('file not uploaded');
                }
            },
        });
    });
});
</script>

<style>
img {
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 5px;
  width: 200px;
}
.container {
  max-width: 750px;
  padding: 15px;
}

/* Preview */
.preview{
   width: 100px;
   height: 100px;
   border: 1px solid black;
   margin: 0 auto;
   background: white;
}

.preview img{
   display: none;
}
</style>

</head>

<body>
 <div class="login">
	<h1 style="text-align: center;">Object Detection WebApp</h1>
    <!-- Main Input For Receiving Query to our ML -->
    <!-- <form action="{{ url_for('get_image_out')}}" method="post">
      <input type="file" name="file" />
      <button type="submit" class="btn btn-primary btn-block btn-large">Upload and Predict</button>
    </form> -->

    <!-- <form onsubmit="return results();" action = "/image_output" method = "POST" enctype = "multipart/form-data">
      <input type = "file" name = "images" />
      <input type = "submit"/>
    </form>

   <br>
   <br>

  <a action="{{url_for('home')}}" type="submit"><button class='btn btn-default'>HOme</button></a> -->

 </div>

<!-- -------------------------------------------------------------------------------------------------------------- -->
  <div class="container">
  <h1>
  <h3  href="javascript:window.location.reload();">File Upload</h3>
  </h1>
  <form class="well" id="myform" method="post" action="/image" target="_blank" enctype="multipart/form-data" data-bind="fileDrag: fileData">
      <div class="form-group row">
          <div class="col-md-6">
              <img style="height: 125px;" class="img-rounded  thumb" data-bind="attr: { src: fileData().dataURL }, visible: fileData().dataURL">
              <div data-bind="ifnot: fileData().dataURL">
                  <label class="drag-label">Drag file here</label>
              </div>
          </div>
          <div class="col-md-6">
              <input id="file" type="file" name="images" data-bind="fileInput: fileData, customFileInput: {
                buttonClass: 'btn btn-success',
                fileNameClass: 'disabled form-control',
                onClear: onClear,
              }" accept="image/*">
          </div>
      </div>
      <button style='margin-left:80%;' class='btn btn-default' id="but_upload" name="show">Show Results!!</button>
  </form>

  </div>

</body>
</html>



